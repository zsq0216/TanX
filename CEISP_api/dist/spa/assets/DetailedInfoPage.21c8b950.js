import{Q as m}from"./QCardSection.161fe826.js";import{k as c,o as u,av as g,a as e,w as t,d as a,aG as P,aH as T,aF as i,W as Y,f as y,N as H,t as U,r as z,c as d,_ as G,ae as f,Y as $,A as S,$ as V,aw as Q,Q as K}from"./index.72b74f6b.js";import{Q as E,e as W}from"./QSelect.27372468.js";import{Q as J}from"./prevent-scroll.e5f540d1.js";import{a as R,Q as X,b}from"./axios.1562a4a6.js";import{Q as Z,a as I}from"./QItem.f6b9adf1.js";import{Q as ee}from"./QItemLabel.b5cd3164.js";import{Q as te}from"./QSeparator.f827b709.js";import{Q as ae,a as oe}from"./QLayout.01a6ef7f.js";import{Q as re}from"./QMarkupTable.d4ac7ee3.js";import{_ as le}from"./ChartComponent.a513bfce.js";import"./use-dark.d9f79254.js";import"./rtl.49e07ec0.js";import"./use-timeout.c4e98ea7.js";import"./scroll.7d6d8e83.js";import"./uid.42677368.js";const se={class:"q-pa-md row justify-center4"},ne=a("h2",{class:"text-h4"},"\u5386\u53F2\u6392\u653E\u6570\u636E",-1),ie=a("thead",null,[a("tr",null,[a("th",{class:"text-left"},"\u65F6\u95F4"),a("th",{class:"text-right"},"\u8303\u56F4\u4E00\u6392\u653E (\u5428CO2)"),a("th",{class:"text-right"},"\u8303\u56F4\u4E8C\u6392\u653E (\u5428CO2)"),a("th",{class:"text-right"},"\u8303\u56F4\u4E09\u6392\u653E (\u5428CO2)"),a("th",{class:"text-right"},"\u603B\u6392\u653E (\u5428CO2)"),a("th",{class:"text-right"},"\u78B3\u62B5\u6D88 (\u5428CO2)")])],-1),ue={__name:"HistoryList",props:{historyData:{type:Array,required:!0}},setup(x){const p=c("vertical");return(_,C)=>(u(),g("div",se,[ne,e(re,{separator:p.value,flat:"",bordered:"",class:"col-10"},{default:t(()=>[ie,a("tbody",null,[(u(!0),g(P,null,T(x.historyData,(n,h)=>(u(),g("tr",{key:h},[a("td",null,i(`${n.year} - ${n.month}`),1),a("td",null,i(n.emission1),1),a("td",null,i(n.emission2),1),a("td",null,i(n.emission3),1),a("td",null,i(n.emission_all),1),a("td",null,i(n.offset),1)]))),128))])]),_:1},8,["separator"])]))}},ce={class:"col-8 q-mb-md q-gutter-md"},me={class:"row"},de={class:"row col-5"},fe={class:"col-3 q-ml-md"},pe=a("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),Ee={__name:"DetailedInfoPage",setup(x){const p=Y(),_=localStorage.getItem("userName"),C=y(()=>p.state.currentMonth),n=y(()=>p.state.currentYear),h=localStorage.getItem("bankToken"),l=H({page:1,month:null,year:null,pagelength:10,username:_}),N=y(()=>`${r.value.year}-${r.value.month}`),k=c(""),w=c(""),r=c(),A=c(""),B=c(""),D=c({}),F=[...Array(new Date().getFullYear()-1999).keys()].map(s=>2e3+s),O=Array.from({length:12},(s,o)=>o+1);function L(s){switch(s){case"all":return"\u5168\u90E8\u8BA4\u8BC1";case"part":return"\u90E8\u5206\u8BA4\u8BC1";case"none":return"\u672A\u8BA4\u8BC1";default:return"\u672A\u77E5"}}function j(s){switch(s){case"all":return"green";case"part":return"orange";case"none":return"red";default:return"grey"}}function q(){console.log("in detailed info page"),console.log(h),console.log(_),(l.username==null||l.month==null||l.year==null)&&G.create({color:"red-5",textColor:"white",icon:"error",message:"\u67E5\u8BE2\u6761\u4EF6\u4E0D\u80FD\u4E3A\u7A7A\uFF01"});const s=new FormData;Object.keys(l).forEach(o=>{s.append(o,l[o])}),R.post("http://47.122.24.142:7766/api/getenterpriseinfo",s,{headers:{Authorization:`Bearer ${h}`}}).then(o=>{o.status===200?(r.value=o.data.show_data,k.value=o.data.Enterprisename,w.value=o.data.Enterpriseintro,A.value=o.data.history_num,B.value=o.data.history_page_max,D.value=o.data.history_data):console.error("Error fetching data:",o.status)}).catch(o=>{console.error("Error fetching data:",o)})}return U(()=>{l.month=C.value,l.year=n.value,q()}),(s,o)=>{const M=z("q-card-sectiont");return u(),d(ae,null,{default:t(()=>[e(oe,null,{default:t(()=>[e(X,{class:"q-pa-md row items-start justify-center"},{default:t(()=>[a("div",ce,[e(b,null,{default:t(()=>[a("div",me,[e(m,{class:"text-h4 col-4"},{default:t(()=>[f(" \u603B\u89C8 ")]),_:1}),e(J,{onSubmit:q,class:"col-12 q-pa-md"},{default:t(()=>[a("div",de,[e(E,{outlined:"",modelValue:l.year,"onUpdate:modelValue":o[0]||(o[0]=v=>l.year=v),options:$(F),label:"\u5E74\u4EFD",type:"number",class:"col-2",padding:""},{prepend:t(()=>[e(S,{name:"event"})]),_:1},8,["modelValue","options"]),e(E,{outlined:"",modelValue:l.month,"onUpdate:modelValue":o[1]||(o[1]=v=>l.month=v),options:$(O),label:"\u6708\u4EFD",type:"number",class:"col-2",padding:""},{prepend:t(()=>[e(S,{name:"event"})]),_:1},8,["modelValue","options"]),e(V,{label:"\u67E5\u8BE2",type:"submit",color:"primary",class:"col-2 q-px-md"})])]),_:1})]),r.value?(u(),d(m,{key:0},{default:t(()=>[(u(),d(le,{key:N.value,fixburn:r.value.fixburn,movingburn:r.value.movingburn,emission1:r.value.emission1,electricity:r.value.electricity,heating:r.value.heating,emission2:r.value.emission2,commuting:r.value.commuting,travel:r.value.travel,emission3:r.value.emission3},null,8,["fixburn","movingburn","emission1","electricity","heating","emission2","commuting","travel","emission3"]))]),_:1})):Q("",!0),r.value?(u(),d(m,{key:1},{default:t(()=>[e(W,{color:j(r.value.certified),style:{color:"white"}},{default:t(()=>[f(i(L(r.value.certified)),1)]),_:1},8,["color"]),r.value.certified==="all"?(u(),d(V,{key:0,label:"\u4E0B\u8F7D\u62A5\u544A",color:"primary",onClick:s.submitForm},null,8,["onClick"])):Q("",!0)]),_:1})):Q("",!0)]),_:1}),e(b,null,{default:t(()=>[e(M,null,{default:t(()=>[e(ue,{historyData:D.value},null,8,["historyData"])]),_:1})]),_:1})]),a("div",fe,[e(b,{class:"fit"},{default:t(()=>[e(m,{class:"text-h4"},{default:t(()=>[f(" \u516C\u53F8\u4FE1\u606F ")]),_:1}),e(Z,null,{default:t(()=>[e(I,{avatar:""},{default:t(()=>[e(K,null,{default:t(()=>[pe]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(ee,null,{default:t(()=>[f(i(k.value),1)]),_:1})]),_:1})]),_:1}),e(te),e(m,{class:"column"},{default:t(()=>[e(m,null,{default:t(()=>[f(" \u516C\u53F8\u4ECB\u7ECD: "),a("span",null,i(w.value),1)]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})}}};export{Ee as default};
